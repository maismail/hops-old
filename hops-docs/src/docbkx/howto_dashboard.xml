<?xml version="1.0" encoding="UTF-8"?>
<chapter version="5.0" xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:ns5="http://www.w3.org/2000/svg" xmlns:ns4="http://www.w3.org/1998/Math/MathML" xmlns:ns3="http://www.w3.org/1999/xhtml" xmlns:db="http://docbook.org/ns/docbook" xml:id="ch03">
    <title>Hop Dashboard</title>
    
    <para>Hop Dashboard is a web application designed with Hadoop administrators in mind. The 
        Dashboard provides a centralized end-to-end management and monitoring application for Hop
        clusters. It simplifies the Hadoop administrator's job by having all the necessary
        statistics of the Hadoop cluster gathered in one place and presented in an effective manner,
        and it also provides buttons to execute maintanance commands as well as command-line terminals
        for services like MySQL and HDFS. The Dashboard monitoring services are built using the
        open-source collectd monitoring software.</para>
    <para>You will need to configure certain parameters when the Hop Dashboard is launched for the
        first time. In order to access the dashboard, use the credentials you specified in the Hop
        Portal when you where preparing to launch the dashboard <xref linkend="ch02"/>. After login,
        if you press your user icon you will have a menu with the following options: <itemizedlist>
            <listitem>
                <para> Change password </para>
            </listitem>
            <listitem>
                <para> Edit Graphs </para>
            </listitem>
            <listitem>
                <para> Backup/Restore </para>
            </listitem>
            <listitem>
                <para> Setup Credentials </para>
            </listitem>
        </itemizedlist> We will go these options in more detail in the following sections. </para>
    <sect1>
        <title>Change Password</title>
        <para>Change the password for this user.</para>
    </sect1>
    <sect1 xml:id="edit_graphs">
        <title>Edit Graphs</title>
        <para>The Hop Dashboard enables the customization of what monitoring data is displayed 
            to administrators. An administrator can select which graphs to enable
            for the different services of Hop. </para>
        <figure xml:id="dash-graphs">
            <title>New/Import Graphs</title>
            <mediaobject>
                <imageobject>
                    <imagedata fileref="media/dash-edit-graphs.png" align="center" scale="30"/>
                </imageobject>
            </mediaobject>
        </figure>
        <para> You can define your graphs through two different options that are visible on this new
            view: <itemizedlist>
                <listitem>
                    <para>
                        <emphasis>New</emphasis> Selecting this option will open a new dialog where
                        you can define the specifications for a new graph for statistics monitored by
                        the dashboard. </para>
                    <figure xml:id="dash-new-graphs">
                        <title>Graph Editor</title>
                        <mediaobject>
                            <imageobject>
                                <imagedata fileref="media/dash-new-graphs.png" align="center"
                                    scale="30"/>
                            </imageobject>
                        </mediaobject>
                    </figure>
                </listitem>
                <listitem>
                    <para>
                        <emphasis>Import</emphasis> It is also possible to import a predefined set of graphs
                        from a JSON file. This is the quickest way to load a large number of graphs. </para>
<!--                    <figure xml:id="dash-import-graphs">
                        <title>Import Graphs</title>
                        <mediaobject>
                            <imageobject>
                                <imagedata fileref="media/dash-import-graphs.png" align="center"
                                    scale="50"/>
                            </imageobject>
                        </mediaobject>
                    </figure>-->
                </listitem>
            </itemizedlist>The graph speficiations are stored in a MySQL database and loaded in
            the dashboard. In the graph table, it is possible to view all the graphs for a specific
            type of service or component that the dashboard is monitoring. Pressing the zoom button
            will generate a dialog box where you can see more details about the graph. </para>
        <figure xml:id="dash-selected-graphs">
            <title>Graph Selection Detail</title>
            <mediaobject>
                <imageobject>
                    <imagedata fileref="media/dash-detail-graphs.png" align="center" scale="30"/>
                </imageobject>
            </mediaobject>
        </figure>
    </sect1>
    <sect1>
        <title>Backup/Restore</title>
        <para>The Dashboard's state is stored entirely in a MySQL database instance. 
            This option makes a backup of the whole dashboard state as an SQL file that
            can be downloaded by the user for off-site backup. In the case of failure
            or maintenence, the dashboard can restore a previous state from a backup SQL file. </para>
        <figure xml:id="dash-backup">
            <title>Backup/Restore</title>
            <mediaobject>
                <imageobject>
                    <imagedata fileref="media/dash-backup-restore.png" align="center" scale="40"/>
                </imageobject>
            </mediaobject>
        </figure> 
    </sect1>
    <sect1>
        <title>Setup Credentials</title>
        <para>This option is to setup user credentials that are used when the dashboard deploys a
            cluster on a cloud platform or cluster. They are typically AWS or OpenStack credentials 
            or a public key for cluster deployments. If user credentials have not been setup,
            cluster deployment will fail.</para>
        <figure xml:id="dash-credentials">
            <title>Setup Credentials</title>
            <mediaobject>
                <imageobject>
                    <imagedata fileref="media/dash-credentials.png" align="center" scale="40"/>
                </imageobject>
            </mediaobject>
        </figure>   
    </sect1>
    
    <sect1>
        <title>Cluster Management</title>
        <para>Cluster mangement is an interesting feature in the Hop Dashboard. The dashboad keeps
            track of diffenent cluster applications deployed in the cloud. It allows the
            administrators to create, delete, edit, load and export clusters.  </para>
        <figure xml:id="dash-manage-cluster">
            <title>Manage Cluster</title>
            <mediaobject>
                <imageobject>
                    <imagedata fileref="media/dash-manage-cluster.png" align="center" scale="40"/>
                </imageobject>
            </mediaobject>
        </figure>
        <para>
            <itemizedlist>
                <listitem>
                    <para><emphasis>Create Cluster</emphasis> Selecting this option will take you to
                        the cluster generation wizard where a users can of generate their own
                        clusters for Hop. In the next chapter, we will explain in detail how users
                        can create their custom clusters using our Cluster Definition Language, see
                            <xref linkend="ch04"/>. </para>
                </listitem>
                <listitem>
                    <para><emphasis>Delete Clusters</emphasis> This option will delete a selected
                        cluster. It is possible to delete multiple clusters at once by shift
                        clicking multiple clusters before selecting this option. </para>
                </listitem>
                <listitem>
                    <para><emphasis>Edit Selected Cluster</emphasis> This option will allow a user
                        to edit an existing stored cluster. Administrators can use this
                        wizard to modify the set of hosts or services in an existing cluster. 
                    They can choose 2 ways to edit a cluster from the entry, they
                        can re-run the cluster wizard or they can choose to use the embedded YAML editor available
                        in the dashboard.</para><figure>
                <title>Select edit mode:</title>
                <mediaobject>
                    <imageobject>
                        <imagedata fileref="media/dash-edit-select.png" align="center"
                            scale="40"/>
                    </imageobject>
                </mediaobject>
            </figure>
            <para>
                If we select the online editor option, it will open the selected cluster 
                into a YAML editor window.
            </para>
            <figure>
                <title>YAML Editor</title>
                <mediaobject>
                    <imageobject>
                        <imagedata fileref="media/dash-yamleditor.png" align="center"
                            scale="40"/>
                    </imageobject>
                </mediaobject>
            </figure>
                        
                </listitem>
                <listitem>
                    <para><emphasis>Load Selected Cluster</emphasis> This option allows the user to
                        load an existing cluster definition from a YAML file. This is a useful
                    feature for reusing cluster definitions - users can share cluster definitions
                    and load them using this option.</para>
                </listitem>
                <listitem>
                    <para><emphasis>Export Cluster</emphasis> It saves the information about the
                        cluster in  a YAML file, so that the cluster definition can be shared. </para>
                </listitem>
            </itemizedlist>
        </para>
    </sect1>
    <sect1>
        <title>Cluster Deployment Progress</title>
        <para>The Hop Dashboard monitors all the nodes deployed in its clusters. It displays the
            history of all the nodes going through multiple phases of the deployment cycle. A
            progress bar appears over each of the entries in the table showing the deployment 
            progress of the nodes. A cluster node goes through the following phases during
            deployment: 
            <itemizedlist>
                <listitem>
                    <para><emphasis>Waiting:</emphasis> An entry has been generated in the node
                        scheduler but no node creation query has been yet been sent to the cloud
                        provider.</para>
                </listitem>
                <listitem>
                    <para><emphasis>Creation:</emphasis> The scheduler has submitted the query to
                        the cloud provider and it is waiting for the cloud provider to finish
                        deploying the virtual instance. When an instance is successfully created an
                        initialization script is executed for preliminary configuration of the node.
                    </para>
                </listitem>
                <listitem>
                    <para><emphasis>Install:</emphasis> After the node is successfully commissioned,
                        chef installs recipes for Hop Services to fetch the necessary binaries from
                        the different repositories. This phase is optional in case of using pre
                        built virtual instances which contain Hop binaries. </para>
                </listitem>
                <listitem>
                    <para><emphasis>Configure:</emphasis> A node in this phase means, that; the node
                        is receiving the configuration script which will execute chef with the
                        selected recipes for the services defined for that node. </para>
                </listitem>
                <listitem>
                    <para><emphasis>Complete:</emphasis> The node has successfully finished
                        executing the configuration script with chef and it is now part of the
                        working cluster. </para>
                </listitem>
                <listitem>
                    <para><emphasis>Retrying:</emphasis> The deployment system has detected a
                        problem during a node deployment phase and it is retrying to recover from
                        the failure. It retries the failed phase script for five times.</para>
                </listitem>
                <listitem>
                    <para><emphasis>Error:</emphasis> When all the retires are exhausted the node is
                        marked erroneous. Hadoop administrator can to take further actions to
                        recover the node, for example, SSH into the failed node and the fix the
                        problem manually, retry the deployment process or delete the failed
                        nodes.</para>
                </listitem>
            </itemizedlist><figure>
                <title>Clusters Progress</title>
                <mediaobject>
                    <imageobject>
                        <imagedata fileref="media/dash-clusters-progress.png" align="center"
                            scale="40"/>
                    </imageobject>
                </mediaobject>
            </figure></para>
    </sect1>
    <sect1>
        <title>Monitoring</title>
        <para>Hop Dashboard uses collectd to monitor hosts, alerts and Hop services in real time. 
            A brief overview of the monitoring tools is given below.   </para>
        <sect2>
            <title>Hosts</title>
            <para>The host monitoring tool shows the state of all the nodes in the clusters. An
                administrator can track information of his/her interest such as the allocated IPs
                for the nodes, hostnames, host IDs, health of the nodes in the system, and when the
                last heartbeat was received from the nodes. It also monitors available resources on
                the nodes such as the number of cores that machine has, average load on the
                instance, disk usage and physical memory in use. </para>
            <figure>
                <title>Hosts</title>
                <mediaobject>
                    <imageobject>
                        <imagedata fileref="media/dash-hosts.png" align="center" scale="35"/>
                    </imageobject>
                </mediaobject>
            </figure>   
            <para>Selecting the host ID's displays a detailed view of the host's analytics with the
                graphs that are available for the hosts. See the <xref linkend="edit_graphs"/>
                section to create or delete graphs for the dashboards monitoring components. </para>
            <figure>
                <title>Hosts Details-Services</title>
                <mediaobject>
                    <imageobject>
                        <imagedata fileref="media/dash-host-detail.png" align="center" scale="35"/>
                    </imageobject>
                </mediaobject>
            </figure>
            <figure>
                <title>Hosts Details Graphs</title>
                <mediaobject>
                    <imageobject>
                        <imagedata fileref="media/dash-host-detail-2.png" align="center" scale="35"/>
                    </imageobject>
                </mediaobject>
            </figure>     
        </sect2>
        <sect2>
            <title>Alerts</title>
            <para>This feature allows the user to view alerts for events of interest to the administrator,
                such as failed hosts, full hard drives, etc. An administrator can filter alerts of certain
                severity and that were generated in a certain time window. The Alerts feature is based on 
                collectd thresholds.</para>
            <figure>
                <title>Alerts</title>
                <mediaobject>
                    <imageobject>
                        <imagedata fileref="media/dash-alerts.png" align="center" scale="35"/>
                    </imageobject>
                </mediaobject>
            </figure>    
        </sect2>
        <sect2>
            <title>Clusters</title>
            <para>The cluster monitoring tool gives a bird eye view of the clusters monitored by the Hop
                Dashboard. It contains information such as the nodes that compose the cluster
                and the health status of the services deployed on those nodes. 
                Also it keeps track of the resources allocated
                to the cluster such as total number of cores which compose the overall computing
                power of the cluster, the total disk capacity and the total physical memory
                capacity. An administrator can drill down into a cluster to find out the list of services
                in the cluster, their status and a list of nodes in each service.  
                Many services can be restarted from the Dashboard.
            </para>
            <figure>
                <title>Clusters</title>
                <mediaobject>
                    <imageobject>
                        <imagedata fileref="media/dash-clusters.png" align="center" scale="35"/>
                    </imageobject>
                </mediaobject>
            </figure>   
            <figure>
                <title>Detailed Cluster View</title>
                <mediaobject>
                    <imageobject>
                        <imagedata fileref="media/dash-cluster-detail.png" align="center" scale="35"/>
                    </imageobject>
                </mediaobject>
            </figure>
            <sect3>
                <title>YARN monitoring</title>
                <para>The Hop Dashboard displays graphs on YARN performance analytics. </para>
                    <figure>
                <title>YARN Metrics</title>
                <mediaobject>
                    <imageobject>
                        <imagedata fileref="media/dash-YARN-metrics.png" align="center" scale="35"/>
                        </imageobject>
                </mediaobject>
            </figure>
            <para>You can also access the Apache websites for the resource and node managers in YARN. </para>
            <figure>
                <title>Resource Manager Metrics</title>
                <mediaobject>
                    <imageobject>
                        <imagedata fileref="media/dash-YARN-resource.png" align="center" scale="35"/>
                        </imageobject>
                </mediaobject>
            </figure>
            <figure>
                <title>Node Manager Metrics</title>
                <mediaobject>
                    <imageobject>
                        <imagedata fileref="media/dash-YARN-manager.png" align="center" scale="35"/>
                        </imageobject>
                </mediaobject>
            </figure>
            <para>The Hop dashboard provides direct access to the resource and node manger web
                    UIs provided by the Apache distribution. 
                    The resource manager web UI gives detailed information about the number of
                    applications submitted, number of applications in progress, number of
                    application completed, total available memory, memory consumed, dead nodes etc.
                    The Node manager web UI displays information such as total memory allocated to the
                    java virtual machine on the node, memory allocated to each container, node
                    health status, hadoop version, etc. </para>
            
            <figure>
                <title>Resource Manager UI</title>
                <mediaobject>
                    <imageobject>
                        <imagedata fileref="media/dash-YARN-resourceUI.png" align="center" scale="35"/>
                        </imageobject>
                </mediaobject>
            </figure>  
               <figure>
                <title>Node Manager UI</title>
                <mediaobject>
                    <imageobject>
                        <imagedata fileref="media/dash-YARN-managerUI.png" align="center" scale="35"/>
                        </imageobject>
                </mediaobject>
            </figure> 
            </sect3>
            <sect3>
                <title>MySQL Cluster</title>
                <para>You can monitor the MySQL Cluster using the Hop Dashboard. Its keeps track of data memory, index
                    memory, number of reads and writes per second and number of scans per second. 
                    Data nodes, management nodes, and MySQL servers can all be restarted
                    from the Dashboard.
                </para>
                 <figure>
                <title>MySQL Cluster Monitor</title>
                <mediaobject>
                    <imageobject>
                        <imagedata fileref="media/dash-MYSQL-graphs.png" align="center" scale="35"/>
                        </imageobject>
                </mediaobject>
            </figure>
                 <para>The dashboard provides a commmand-line terminal to directly run
                    SQL commands on a MySQL Server connected to NDB.</para>
                  <figure>
                <title>MySQL Console</title>
                <mediaobject>
                    <imageobject>
                        <imagedata fileref="media/dash-MYSQL-console.png" align="center" scale="50"/>
                        </imageobject>
                </mediaobject>
            </figure>
            </sect3>
            <sect3>
                <title>Hop HDFS Console</title>
                <para>The dashboard provides a command-line terminal for executing HDFS operations
                    using the HDFS client. It perform operations such as ls, mkdir, cat, etc.
                </para>
                <figure>
                <title>Hdfs Console</title>
                <mediaobject>
                    <imageobject>
                        <imagedata fileref="media/dash-HOP-console.png" align="center" scale="50"/>
                        </imageobject>
                </mediaobject>
            </figure>
            </sect3>
        </sect2>
    </sect1>
    
   
</chapter>
